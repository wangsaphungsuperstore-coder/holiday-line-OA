<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>อัตราค่าปรับหอพัก</title>
  
  <style>
    /* ------------------------------------- */
    /* Mobile-First & Warm Color Design CSS  */
    /* ------------------------------------- */
    
    :root {
      --color-primary: #8B4513; /* น้ำตาลเข้ม (Accent) */
      --color-secondary: #D2B48C; /* น้ำตาลอ่อน/แทน (Background Accent) */
      --color-background: #FFF8E1; /* เหลืองอ่อนมาก (Warm White) */
      --color-text: #4E342E; /* น้ำตาลเกือบดำ */
      --color-warning: #FFC107; /* เหลืองเตือน */
      --color-safe: #4CAF50; /* เขียวปลอดภัย */
    }
    
    body {
      font-family: 'Sukhumvit Set', 'Kanit', sans-serif; /* ฟอนต์ที่ดูดีในมือถือ */
      background-color: var(--color-background);
      color: var(--color-text);
      padding: 15px;
      margin: 0;
      text-align: center;
    }
    
    .container {
      max-width: 450px; /* จำกัดความกว้างสำหรับมือถือ */
      margin: 0 auto;
      padding: 20px;
      background-color: white;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    h1 {
      color: var(--color-primary);
      font-size: 1.8em;
      margin-bottom: 5px;
    }
    
    h2 {
      font-size: 1.5em;
      margin-top: 25px;
      color: var(--color-primary);
      border-bottom: 2px solid var(--color-secondary);
      padding-bottom: 5px;
    }

    .date-display {
      font-size: 1.1em;
      color: #6D4C41; /* น้ำตาลกลาง */
      margin-bottom: 20px;
    }
    
.fine-box {
  background-color: white; /* เปลี่ยนเป็นสีขาวเพื่อให้สีแดงเด่นขึ้น */
  color: var(--color-text);
  padding: 20px;
  border-radius: 8px;
  margin: 25px 0;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); /* เพิ่มเงาให้ดูมีมิติมากขึ้น */
}
    
    .fine-label {
      font-size: 1.1em;
      font-weight: 500;
      margin-bottom: 5px;
    }
    
.fine-amount {
  font-size: 3.5em; /* ตัวเลขใหญ่สำหรับมือถือ */
  font-weight: bold;
  color: #DC3545; /* สีแดงเข้ม (Danger Red) */
  line-height: 1;
}
    
    .fine-unit {
      font-size: 1.5em;
      font-weight: 500;
      display: block;
    }
    
    .status-message {
        padding: 10px;
        margin-top: 15px;
        border-radius: 5px;
        font-weight: bold;
        font-size: 1.1em;
    }

    .status-safe {
        background-color: var(--color-safe);
        color: white;
    }

    .status-warning {
        background-color: var(--color-warning);
        color: var(--color-text);
    }


    /* ตารางอ้างอิง */
    .fine-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
      font-size: 1em;
    }
    
    .fine-table th, .fine-table td {
      border: 1px solid var(--color-secondary);
      padding: 10px 8px;
    }
    
    .fine-table th {
      background-color: var(--color-primary);
      color: white;
      font-weight: bold;
    }
    
    .fine-table tr:nth-child(even) {
      background-color: #FBEFDD; /* เหลืองอ่อนสลับแถว */
    }
    
    /* เน้นวันที่ปัจจุบันในตาราง (ถ้ามี) */
    .highlight-row {
      background-color: var(--color-warning) !important;
      font-weight: bold;
      color: var(--color-text);
    }
    
    @media (max-width: 992px) {
   html, body {
   width: 100%;
}
    .container {
      max-width: 85%; /* จำกัดความกว้างสำหรับมือถือ */
      margin: 0 auto;
    }

    h1 {
      color: var(--color-primary);
      font-size: 3em;
      margin-bottom: 5px;
    }
    
    h2 {
      font-size: 3em;
      margin-top: 25px;
      padding-bottom: 5px;
    }

    .date-display {
      font-size: 3em;
      margin-bottom: 20px;
    }
    
.fine-box {
  padding: 20px;
  border-radius: 8px;
  margin: 25px 0;
}
    
    .fine-label {
      font-size: 3em;
      font-weight: 500;
      margin-bottom: 5px;
    }
    
.fine-amount {
  font-size: 6em; /* ตัวเลขใหญ่สำหรับมือถือ */
  font-weight: bold;
  line-height: 1;
}
    
    .fine-unit {
      font-size: 3em;
      font-weight: 500;
      display: block;
    }
    
    .status-message {
        padding: 10px;
        margin-top: 15px;
        border-radius: 5px;
        font-weight: bold;
        font-size: 3em;
    }



    /* ตารางอ้างอิง */
    .fine-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 35px;
      font-size: 3em;
    }
    
    .fine-table th, .fine-table td {
      border: 1px solid var(--color-secondary);
      padding: 10px 8px;
    }
    }

  </style>
</head>
<body>

  <div class="container">
    
    <h1>อัตราค่าปรับ</h1>
    
    <div class="date-display" id="current-date">
      </div>

    <div class="fine-box">
      <div class="fine-label">ค่าปรับที่ต้องชำระในวันนี้ (฿)</div>
      <div class="fine-amount" id="current-fine-amount">
        </div>
    </div>
    
    <div class="status-message" id="status-message">
        </div>
    
    <h2>ตารางอ้างอิง</h2>
    <table class="fine-table">
      <thead>
        <tr>
          <th>ชำระภายในวันที่</th>
          <th>ค่าปรับ (บาท)</th>
        </tr>
      </thead>
      <tbody id="reference-table-body">
        </tbody>
    </table>
    
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function() {
      // เรียกฟังก์ชันใน Code.gs เพื่อดึงข้อมูล
      google.script.run
        .withSuccessHandler(displayData)
        .getFineData();
    });

    /**
     * ฟังก์ชันแสดงผลข้อมูลที่ได้จาก Google Apps Script
     * @param {object} data - ข้อมูลที่ส่งกลับมาจาก getFineData()
     */
    function displayData(data) {
      const today = new Date();
      const todayDate = today.getDate();
      
      // 1. แสดงวันที่ปัจจุบัน
      document.getElementById('current-date').textContent = `ณ ${data.formattedDate}`;
      
      // 2. แสดงค่าปรับหลัก
      const fineAmountDisplay = document.getElementById('current-fine-amount');
      fineAmountDisplay.innerHTML = `${data.currentFine.toLocaleString('th-TH')}`;
      
      // 3. แสดงข้อความสถานะ
      const statusMessage = document.getElementById('status-message');
      if (data.currentFine === 0) {
          statusMessage.textContent = 'ชำระวันนี้ ไม่มีค่าปรับค่ะ';
          statusMessage.classList.add('status-safe');
      } else {
          statusMessage.textContent = `ชำระวันนี้ มีค่าปรับรวม ${data.currentFine.toLocaleString('th-TH')} บาทค่ะ`;
          statusMessage.classList.add('status-warning');
      }

      // 4. แสดงตารางอ้างอิง
      const tableBody = document.getElementById('reference-table-body');
      tableBody.innerHTML = ''; // ล้างข้อมูลเก่า
      
      data.referenceTable.forEach(item => {
        const row = tableBody.insertRow();
        
        // ถ้าวันที่ในตารางตรงกับวันที่ปัจจุบัน ให้เน้นแถวนั้น
        if (item.day === todayDate) {
          row.classList.add('highlight-row');
        }
        
        // Cell 1: วันที่ชำระ
        const dayCell = row.insertCell();
        dayCell.textContent = item.day;
        
        // Cell 2: ค่าปรับ
        const fineCell = row.insertCell();
        fineCell.textContent = item.fine.toLocaleString('th-TH');
      });
    }
  </script>
</body>
</html>
